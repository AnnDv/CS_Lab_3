[
    {
        "serial_number_custom_item": 0,
        "type": "CMD_EXEC",
        "description": "\"MacOS 11 is installed\"",
        "cmd": "\"/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'\"",
        "expect": "\"^ProductVersion[\\\\s]*:[\\\\s]*11\\\\.\""
    },
    {
        "serial_number_custom_item": 2,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"1.2 Enable Auto Update\"",
        "regex": "\"1\"",
        "plist_item": "\"AutomaticCheckEnabled\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"Auto Update verifies that your system has the newest security patches and software updates. If 'Automatically check for updates' is not selected background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.",
        "reference": "\"800-171|3.14.1,800-53|SI-2(5),CIS_Recommendation|1.2,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,QCSC-v1|11.2,SWIFT-CSCv1|2.2\"",
        "solution": "\"Perform the following to enable the system to automatically check for updates:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 3,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"1.3 Enable Download new updates when available\"",
        "regex": "\"1\"",
        "plist_item": "\"AutomaticDownload\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"In the GUI both 'Install macOS updates' and 'Install app updates from the App Store' are dependent on whether 'Download new updates when available' is selected.",
        "reference": "\"800-171|3.14.1,800-53|SI-2(5),CIS_Recommendation|1.3,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,QCSC-v1|11.2,SWIFT-CSCv1|2.2\"",
        "solution": "\"Perform the following to enable the system to automatically check for updates:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 4,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"1.4 Enable app update installs\"",
        "regex": "\"1\"",
        "plist_item": "\"AutoUpdate\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or admin privileges for end users.",
        "reference": "\"800-171|3.14.1,800-53|SI-2(5),CIS_Recommendation|1.4,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,QCSC-v1|11.2,SWIFT-CSCv1|2.2\"",
        "solution": "\"Perform the following to enable App Store updates to install automatically:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 5,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"1.5 Enable system data files and security updates install - 'ConfigDataInstall'\"",
        "regex": "\"1\"",
        "plist_item": "\"ConfigDataInstall\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper. With this setting in place new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights.",
        "reference": "\"800-171|3.14.1,800-53|SI-2(5),CIS_Recommendation|1.5,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,QCSC-v1|11.2,SWIFT-CSCv1|2.2\"",
        "solution": "\"Perform the following to enable system data files and security updates to install automatically:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 6,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"1.5 Enable system data files and security updates install - 'CriticalUpdateInstall'\"",
        "regex": "\"1\"",
        "plist_item": "\"CriticalUpdateInstall\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper. With this setting in place new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights.",
        "reference": "\"800-171|3.14.1,800-53|SI-2(5),CIS_Recommendation|1.5,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,QCSC-v1|11.2,SWIFT-CSCv1|2.2\"",
        "solution": "\"Perform the following to enable system data files and security updates to install automatically:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 7,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"1.6 Enable macOS update installs\"",
        "regex": "\"1\"",
        "plist_item": "\"AutomaticallyInstallMacOSUpdates\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to test first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off so the admin can call the users first to let them know it's ok to install. A dependable, repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.",
        "reference": "\"800-171|3.14.1,800-53|SI-2(5),CIS_Recommendation|1.6,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,QCSC-v1|11.2,SWIFT-CSCv1|2.2\"",
        "solution": "\"Perform the following to enable macOS updates to run automatically:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 8,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"2.1.1 Turn off Bluetooth, if no paired devices exist\"",
        "regex": "\"0\"",
        "plist_item": "\"ControllerPowerState\"",
        "plist_option": "CANNOT_BE_NULL",
        "reference": "type: MACOSX_DEFAULTS_READ"
    },
    {
        "serial_number_custom_item": 9,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"2.1.1 Turn off Bluetooth, if no paired devices exist\"",
        "expect": "type: MACOSX_DEFAULTS_READ",
        "regex": "\"0\"",
        "plist_item": "\"ControllerPowerState\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"Bluetooth devices use a wireless communications system that replaces the cables used by other peripherals to connect to a system. It is by design a peer-to-peer network technology and typically lacks centralized administration and security enforcement infrastructure.",
        "reference": "\"800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CIS_Recommendation|2.1.1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3\"",
        "solution": "\"Perform the following to disable Bluetooth:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 10,
        "type": "CMD_EXEC",
        "description": "\"2.1.1 Turn off Bluetooth, if no paired devices exist\"",
        "cmd": "\"/usr/sbin/system_profiler SPBluetoothDataType | /usr/bin/grep \\\"Bluetooth:\\\" -A 20 | /usr/bin/grep Connectable\"",
        "expect": "\"Connectable: Yes\"",
        "info": "\"Bluetooth devices use a wireless communications system that replaces the cables used by other peripherals to connect to a system. It is by design a peer-to-peer network technology and typically lacks centralized administration and security enforcement infrastructure.",
        "reference": "\"800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CIP|007-6-R1,CIS_Recommendation|2.1.1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3\"",
        "solution": "\"Perform the following to disable Bluetooth:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 11,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"2.1.2 Show Bluetooth status in menu bar\"",
        "regex": "\"18\"",
        "plist_item": "\"Bluetooth\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.",
        "reference": "\"800-171|3.4.2,800-53|CM-6b.,CIS_Recommendation|2.1.2,CN-L3|8.1.10.6(d),CSCv7|9.2,CSF|PR.IP-1,ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3\"",
        "solution": "\"Perform the following to enable Bluetooth status in the menu bar:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 12,
        "type": "CMD_EXEC",
        "description": "\"2.2.1 Enable 'Set time and date automatically' - Set time and date automatically\"",
        "cmd": "\"/usr/sbin/systemsetup -getusingnetworktime\"",
        "expect": "\"Network Time:[\\\\s]*On\"",
        "info": "\"Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries.",
        "reference": "\"800-171|3.3.7,800-53|AU-8(1),CIS_Recommendation|2.2.1,CN-L3|8.1.4.3(b),CSCv6|6.1,CSCv7|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),LEVEL|1A,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4\"",
        "solution": "\"Perform the following to enable the date and time to be set automatically:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 13,
        "type": "CMD_EXEC",
        "description": "\"2.2.2 Ensure time set is within appropriate limits\"",
        "cmd": "\"sntp `/usr/sbin/systemsetup -getnetworktimeserver | cut -d ' ' -f 4` | grep '+/-' | cut -d ' ' -f 4,5,6\"",
        "expect": "\"^[\\\\-\\\\+]?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-6][0-9]|270)\\\\.([\\\\d]{1,6})[\\\\s]+\\\\+\\\\/\\\\-[\\\\s]+([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-6][0-9]|270)\\\\.([\\\\d]{1,6})[\\\\s]*$\"",
        "info": "\"Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds. For this audit, a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of macOS integration into Directory systems the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time, this check is not strict,so it may be too great for your organization. Your organization can adjust to a smaller offset value as needed.",
        "reference": "\"800-171|3.4.2,800-53|CM-6b.,CIS_Recommendation|2.2.2,CN-L3|8.1.10.6(d),CSCv7|6.1,CSF|PR.IP-1,ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3\"",
        "solution": "\"Run the following commands to ensure your time is set within an appropriate limit:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 14,
        "type": "MACOSX_DEFAULTS_READ",
        "description": "\"2.3.1 Set an inactivity interval of 20 minutes or less for the screen saver\"",
        "regex": "\".* = ([1-9]|[1-9][0-9]|[1-9][0-9][0-9]|1[0-1][0-9][0-9]|1200)$\"",
        "plist_item": "\"idleTime\"",
        "plist_option": "CANNOT_BE_NULL",
        "info": "\"A locking screensaver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In macOS, the screensaver starts after a value is selected in the drop down menu. 20 minutes or less is an acceptable value. Any value can be selected through the command line or script but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.",
        "reference": "\"800-171|3.1.10,800-53|AC-11.,CIS_Recommendation|2.3.1,CN-L3|8.1.4.1(b),CSCv6|16.5,CSCv7|16.11,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d\"",
        "solution": "\"Perform the following to set the screen saver to activate in 20 minutes of less:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 15,
        "type": "CMD_EXEC",
        "description": "\"2.3.3 Familiarize users with screen lock tools or corner to Start Screen Saver\"",
        "cmd": "\"/usr/bin/defaults read ~/Library/Preferences/com.apple.dock | /usr/bin/grep -i corner\"",
        "expect": "\"\\\".*-corner\\\"[\\\\s]*=[\\\\s]*(5|10);$\"",
        "info": "\"In 10.13 Apple added a 'Lock Screen' option to the Apple Menu. Prior to this the best quick lock options were to use either a lock screen option with the screen saver or the lock screen option from Keychain Access if status was made available in the menu bar. With 10.13 the menu bar option is no longer available. The intent of this control is to resemble control-alt-delete on Windows Systems as a means of quickly locking the screen. If the user of the system is stepping away from the computer the best practice is to lock the screen and setting a hot corner is an appropriate method.",
        "reference": "\"800-171|3.1.10,800-53|AC-11a.,CIS_Recommendation|2.3.3,CN-L3|8.1.4.1(b),CSCv7|16.11,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,LEVEL|1M,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b\"",
        "solution": "\"Perform the following to set a Hot Corner to either Start Screen Saver or Put Display to Sleep:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 16,
        "type": "CMD_EXEC",
        "description": "\"2.4.1 Disable Remote Apple Events\"",
        "cmd": "\"/usr/sbin/systemsetup -getremoteappleevents\"",
        "expect": "\"^Remote Apple Events:[\\\\s]*Off\"",
        "info": "\"Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.",
        "reference": "\"800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CIP|007-6-R1,CIS_Recommendation|2.4.1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,QCSC-v1|3.2,SWIFT-CSCv1|2.3\"",
        "solution": "\"Perform the following to disable Remote Apple Events:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 17,
        "type": "CMD_EXEC",
        "description": "\"2.4.2 Disable Internet Sharing\"",
        "cmd": "\"/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.nat | /usr/bin/grep -i Enabled | /usr/bin/grep -v 0 | /usr/bin/awk '{print} END {if (NR == 0) print\\\"pass\\\"}'\"",
        "expect": "\"pass\"",
        "info": "\"Internet Sharing uses the open source natd process to share an internet connection with other computers and devices on a local network. This allows the Mac to function as a router and share the connection to other, possibly unauthorized, devices.",
        "reference": "\"800-171|3.4.2,800-53|CM-6b.,CIS_Recommendation|2.4.2,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv7|9.2,CSF|PR.IP-1,ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3\"",
        "solution": "\"Perform the following to disable Internet Sharing:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 18,
        "type": "CMD_EXEC",
        "description": "\"2.4.3 Disable Screen Sharing\"",
        "cmd": "\"/bin/launchctl print-disabled system | /usr/bin/grep -c '\\\"com.apple.screensharing\\\" => true'\"",
        "expect": "\"1\"",
        "info": "\"Screen Sharing allows a computer to connect to another computer on a network and display the computer's screen. While sharing the computer's screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.",
        "reference": "\"800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,CIS_Recommendation|2.4.3,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,QCSC-v1|3.2,SWIFT-CSCv1|2.3\"",
        "solution": "\"Perform the following to disable Screen Sharing:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    },
    {
        "serial_number_custom_item": 20,
        "type": "CMD_EXEC",
        "description": "\"2.4.5 Disable Remote Login\"",
        "cmd": "\"/usr/sbin/systemsetup -getremotelogin\"",
        "expect": "\"^Remote[\\\\s]*Login:[\\\\s]*Off$\"",
        "info": "\"Remote Login allows an interactive terminal connection to a computer.",
        "reference": "\"800-171|3.1.1,800-171|3.1.2,800-53|AC-17.,CIP|005-5-R2,CIS_Recommendation|2.4.5,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSCv7|9.2,CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,LEVEL|1A,NESA|T5.4.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.6\"",
        "solution": "\"Perform the following to disable Remote Login:",
        "see_also": "\"https://workbench.cisecurity.org/files/3425\""
    }
]